<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ—Ç–∞–ª–∏ –∏–≥—Ä—ã</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="game-details.css">
</head>
<body onload="init()">
    <header>
        <div class="logo">G</div>
        <nav>
            <ul>
                <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li><a href="catalog.html">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                <li><a href="index.html#recommended">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</a></li>
                <li><a href="index.html#new-releases">–ù–æ–≤–∏–Ω–∫–∏</a></li>
                <li><a href="index.html#sales">–°–∫–∏–¥–∫–∏</a></li>
            </ul>
        </nav>
        <div class="icons">
            <div id="cart-container" onclick="window.location.href='cart.html'">üõí</div>
        </div>
    </header>
    
    <main>
        <div id="gameDetailsContainer">
            <h1 id="gameTitle"></h1>
            <img id="gameImage" src="" alt="Game Image">
            <p id="gamePrice"></p>
            <button onclick="add()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
            <div class="tabs">
                <button class="tab-button" onclick="openTab('game')">–û–± –∏–≥—Ä–µ</button>
                <button class="tab-button" onclick="openTab('requirements')">–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</button>
                <button class="tab-button" onclick="openTab('activation')">–ê–∫—Ç–∏–≤–∞—Ü–∏—è</button>
            </div>
            <div id="game" class="tab-content" style="display:block">
                <h2>–û–ø–∏—Å–∞–Ω–∏–µ</h2>
                <p id="gameDescription"></p>
            </div>
            <div id="requirements" class="tab-content" style="display:none">
                <h2>–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è</h2>
                <p id="gameRequirements"></p>
            </div>
            <div id="activation" class="tab-content" style="display:none">
                <ol>
                    <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω–Ω–æ–π –∏–≥—Ä—ã —Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã</li>
                    <li>–ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∫–ª–∏–µ–Ω—Ç Steam, <a class="as" href="http://store.steampowered.com/about/" target="_blank">—Å–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ</a>.</li>
                    <li>–í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç Steam –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π, –µ—Å–ª–∏ —É –≤–∞—Å –µ–≥–æ –Ω–µ—Ç.</li>
                    <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª ¬´–ò–≥—Ä—ã¬ª –∏ –≤—ã–±–µ—Ä–∏—Ç–µ ¬´–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Steam...¬ª. </li>
                    <li>–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.</li>
                    <li>–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏–≥—Ä–∞ –±—É–¥–µ—Ç –≤ –≤–∞—à–µ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–µ Steam, –∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ –µ—ë —Å–∫–∞—á–∞—Ç—å.</li>
                </ol>
            </div>
            <h2>–û—Ç–∑—ã–≤—ã</h2>
            <div id="reviewsContainer">
                <div id="gameReviews"></div>
                <form id="reviewForm" onsubmit="submitReview(event)">
                    <input type="text" id="username" name="username" placeholder="–í–∞—à–µ –∏–º—è" required>
                    <input type="number" id="rating" name="rating" min="1" max="5" placeholder="–†–µ–π—Ç–∏–Ω–≥ (1-5)" required>
                    <textarea id="comment" name="comment" placeholder="–í–∞—à –æ—Ç–∑—ã–≤" required></textarea>
                    <button type="submit">–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</button>
                </form>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h3>–û –Ω–∞—Å</h3>
                <p>–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ü–µ–ª–∏.</p>
            </div>
            <div class="footer-section">
                <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
                <ul>
                    <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
                    <li><a href="index.html#categories">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                    <li><a href="index.html#recommended">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</a></li>
                    <li><a href="index.html#new-releases">–ù–æ–≤–∏–Ω–∫–∏</a></li>
                    <li><a href="index.html#sales">–°–∫–∏–¥–∫–∏</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                <p>–¢–µ–ª–µ—Ñ–æ–Ω: +7 123 456 7890</p>
                <p>Email: support@example.com</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2024 –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω –∏–≥—Ä. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        function openTab(tabName) {
            var i, x, tablinks;
            x = document.getElementsByClassName("tab-content");
            for (i = 0; i < x.length; i++) {
                x[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < x.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            event.currentTarget.className += " active";
        }

        function getGameIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('gameId');
        }

        function init() {
            const gameId = getGameIdFromUrl();
            fetchGameDetails(gameId);
        }
        document.addEventListener('DOMContentLoaded', function() {
    const params = new URLSearchParams(window.location.search);
    const gameId = params.get('gameId');
    fetchGameDetails(gameId);
});
        function fetchGameDetails(gameId) {
            fetch(`/api/game/${gameId}`)
                .then(response => response.json())
                .then(game => {
                    document.getElementById('gameTitle').textContent = game.Title;
                    document.getElementById('gameImage').src = game.ImageURL;
                    document.getElementById('gamePrice').textContent = `–¶–µ–Ω–∞: ${game.Price} —Ä—É–±.`;
                    document.getElementById('gameDescription').textContent = game.Description;

                    const requirements = `
                        <p><strong>–í–∏–¥–µ–æ–∫–∞—Ä—Ç–∞:</strong> ${game.GPU}</p>
                        <p><strong>–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä:</strong> ${game.CPU}</p>
                        <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏:</strong> ${game.Storage}</p>
                        <p><strong>–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å:</strong> ${game.RAM}</p>
                    `;
                    document.getElementById('gameRequirements').innerHTML = requirements;

                    loadReviews(gameId);
                })
                .catch(error => console.error('Error fetching game details:', error));
        }

        function loadReviews(gameId) {
            fetch(`/api/reviews/${gameId}`)
                .then(response => response.json())
                .then(reviews => {
                    const reviewsContainer = document.getElementById('gameReviews');
                    reviewsContainer.innerHTML = '';
                    reviews.forEach(review => {
                        const reviewElement = document.createElement('div');
                        reviewElement.className = 'review';
                        reviewElement.innerHTML = `
                            <p><strong>${review.Username}</strong> (${new Date(review.ReviewDate).toLocaleDateString()}):</p>
                            <p>–†–µ–π—Ç–∏–Ω–≥: ${review.Rating}/5</p>
                            <p>${review.Comment}</p>
                        `;
                        reviewsContainer.appendChild(reviewElement);
                    });
                })
                .catch(error => console.error('Error fetching reviews:', error));
        }

        function submitReview(event) {
            event.preventDefault();
            const gameId = getGameIdFromUrl();
            const formData = new FormData(document.getElementById('reviewForm'));
            formData.append('gameId', gameId);

            fetch('/api/reviews', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    loadReviews(gameId);
                    document.getElementById('reviewForm').reset();
                } else {
                    console.error('Error submitting review');
                }
            })
            .catch(error => console.error('Error submitting review:', error));
        }
        function add() {
        const params = new URLSearchParams(window.location.search);
        const gameTitle = document.getElementById('gameTitle').textContent;
        const gamePrice = document.getElementById('gamePrice').textContent;
        const gameImage = document.getElementById('gameImage').src;
        const GameID = params.get('gameId');

        
        addToCart(gameTitle, gamePrice, gameImage, GameID)

        console.log('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É:', gameDetails);
       
    }
    </script>
</body>
</html>
